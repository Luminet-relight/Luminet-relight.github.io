<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="LumiNet: Latent Intrinsics Meets Diffusion Models for Indoor Scene Relighting.">
  <meta name="keywords" content="Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ðŸ’¡ LumiNet</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" src="ðŸ’¡">
  <!-- Glide.js CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.core.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.theme.min.css">

  <!-- Glide.js JavaScript -->
  <script src="./scripts/carousel.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/glide.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="./static/js/magnify.js"></script>

  <style>
    body {
        font-family: Arial, sans-serif;
    }
    .container {
      max-width: 1200px; /* Adjust as needed */
      margin: 0 auto; /* Centers the container horizontally */
      padding: 20px; /* Optional: add padding for spacing */
      display: block; /* Ensure it behaves as a block-level element */
  }
  
    .image-container {
        position: relative;
        display: inline-block;
        width: 300px;
        height: 450px;
        overflow: hidden;
    }
    .image-container img {
        width: 100%;
        height: auto;
    }
    .magnifier {
    position: absolute;
    border: 2px solid #000;
    border-radius: 50%;
    cursor: none;
    pointer-events: none;
    width: 100px;
    height: 100px;
    display: none;
    background-repeat: no-repeat;
    background-color: rgba(255, 255, 255, 0.6);
    box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
}

  </style>
  
</head>
<body>

<!-- <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
    </div>

  </div>
</nav> -->


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">ðŸ’¡ LumiNet: Latent Intrinsics Meets Diffusion Models for Indoor Scene Relighting</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://xyxingx.github.io">Xiaoyan Xing</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://www.bosch-ai.com/about-us/our-people/konrad-groh/">Konrad Groh</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://karaoglusezer.github.io/">Sezer Karaoglu</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://staff.fnwi.uva.nl/th.gevers/">Theo Gevers</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://anandbhattad.github.io/">Anand Bhattad</a><sup>3</sup>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>UvA-Bosch Delta Lab</span>
            <span class="author-block"><sup>2</sup>BCAI-Bosch</span>
            <span class="author-block"><sup>3</sup>Toyota Technological Institute at Chicago</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="./static/arxiv.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="#"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video (Coming Soon)</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <!-- <span class="link-block">
                <a href="#"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Coming soon)</span>
                  </a>
              </span> -->

            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <div class="columns is-centered">
      <img src="./static/images/new_teaser_v5.svg">
    </div>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">LumiNet</span> transfers complex lighting conditions between real world indoor scenes. 
      </h2>
 
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>We introduce LumiNet, a novel architecture that leverages generative models and latent intrinsic representations for effective lighting transfer. </p>
          
          <p>Given a source image and a target lighting image, LumiNet synthesizes a relit version of the source scene that captures the target's lighting.  
            Our approach makes two key contributions: a data curation strategy from the StyleGAN-based relighting model for our training, and a modified diffusion-based ControlNet that processes both latent intrinsic properties from the source image and latent extrinsic properties from the target image. We further improve lighting transfer through a learned adaptor (MLP) that injects the target's latent extrinsic properties via cross-attention and fine-tuning. </p>

          <p>Unlike traditional ControlNet, which generates images with conditional maps from a single scene, LumiNet processes latent representations from two different images - preserving geometry and albedo from the source while transferring lighting characteristics from the target.
             Experiments demonstrate that our method successfully transfers complex lighting phenomena including specular highlights and indirect illumination across scenes with varying spatial layouts and materials, outperforming existing approaches on challenging indoor scenes using only images as input.</p>
          </p>
        </div>
      </div>
    </div>

    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
            <h2 class="title is-3">Lighting Transfer Results</h2>
            <div id="image-carousel" class="glide">
                <div class="glide__track" data-glide-el="track">
                    <ul class="glide__slides">
                        <!-- Pair 1 -->
                        <!-- Pair 1 -->
                      <li class="glide__slide">
                        <div class="columns is-centered">
                            <div class="image-container" id="image1">
                                <img src="./static/images/source1.png" alt="Source image 1">
                                <div class="magnifier"></div>
                            </div>
                            <div class="image-container" id="image2">
                                <img src="./static/images/relight1.png" alt="Relit image 1">
                                <div class="magnifier"></div>
                            </div>
                        </div>
                      </li>
                      <!-- Pair 2 -->
                      <li class="glide__slide">
                        <div class="columns is-centered">
                            <div class="image-container" id="image3">
                                <img src="./static/images/source2.png" alt="Source image 2">
                                <div class="magnifier"></div>
                            </div>
                            <div class="image-container" id="image4">
                                <img src="./static/images/relit2.png" alt="Relit image 2">
                                <div class="magnifier"></div>
                            </div>
                        </div>
                      </li>
                      <li class="glide__slide">
                        <div class="columns is-centered">
                            <div class="image-container" id="image5">
                                <img src="./static/images/source3.png" alt="Source image 2">
                                <div class="magnifier"></div>
                            </div>
                            <div class="image-container" id="image6">
                                <img src="./static/images/relit3.png" alt="Relit image 2">
                                <div class="magnifier"></div>
                            </div>
                        </div>
                      </li>
                      <li class="glide__slide">
                        <div class="columns is-centered">
                            <div class="image-container" id="image7">
                                <img src="./static/images/source4.png" alt="Source image 2">
                                <div class="magnifier"></div>
                            </div>
                            <div class="image-container" id="image8">
                                <img src="./static/images/relit4.png" alt="Relit image 2">
                                <div class="magnifier"></div>
                            </div>
                        </div>
                      </li>
                        <!-- Add more pairs as needed -->
                    </ul>
                </div>
                <!-- Navigation controls -->
                <div class="glide__arrows" data-glide-el="controls">
                    <button class="glide__arrow glide__arrow--left" data-glide-dir="<">â—€</button>
                    <button class="glide__arrow glide__arrow--right" data-glide-dir=">">â–¶</button>
                </div>
            </div>
        </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
          // Initialize the carousel
          const glide = new Glide('#image-carousel', {
              type: 'carousel',
              perView: 1,
              focusAt: 'center',
              autoplay: false,
              hoverpause: true
          });
  
          // Function to reinitialize magnify for the active slide
          function reinitializeMagnify() {
              // Find the currently active slide
              const activeSlide = document.querySelector('.glide__slide--active');
              if (!activeSlide) {
                  console.error('No active slide found.');
                  return;
              }
  
              // Find the image containers in the active slide
              const containers = activeSlide.querySelectorAll('.image-container');
              if (containers.length >= 2) {
                  const container1 = containers[0];
                  const container2 = containers[1];
  
                  // Get their IDs
                  const container1Id = container1.id;
                  const container2Id = container2.id;
  
                  console.log(`Reinitializing magnify for ${container1Id} and ${container2Id}`);
  
                  // Reinitialize magnifyLinked for these containers
                  magnifyLinked(container1Id, container2Id, 2);
              } else {
                  console.error('Active slide does not contain two image containers.');
              }
          }
  
          // Reinitialize magnify on the first load
          reinitializeMagnify();
  
          // Update magnify whenever the slide changes
          glide.on('run.after', reinitializeMagnify);
  
          // Mount the carousel
          glide.mount();
      });
  </script>
  <h3 class="title is-5">This project page is under construction and will be updated very frequently. Stay tuned!</h3>
    <!-- <div class="col-md-10 col-md-offset-1"> -->
     
    <!-- </div> -->
    <!-- <script>
      document.addEventListener('DOMContentLoaded', function () {
          new Glide('#image-carousel', {
              type: 'carousel',
              perView: 1,
              focusAt: 'center',
              autoplay: false,
              hoverpause: true
          }).mount();
      });
  </script> -->
  

    <!-- <script>
        // Initialize magnify for each image container
        magnify("image1", 2); // Pass container ID and zoom level
        magnify("image2", 2);
    </script> -->

    
  
  
  
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video (Coming Soon)</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>




<!-- <section class="section">
  <div class="container is-max-desktop">

    <div class="columns is-centered">
      <div class="column">
        <div class="content">
          <h2 class="title is-3">Visual Effects</h2>
          <p>
            Using <i>nerfies</i> you can create fun visual effects. This Dolly zoom effect
            would be impossible without nerfies since it would require going through a wall.
          </p>
          <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/dollyzoom-stacked.mp4"
                    type="video/mp4">
          </video>
        </div>

      <div class="column">
        <h2 class="title is-3">Matting</h2>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              As a byproduct of our method, we can also solve the matting problem by ignoring
              samples that fall outside of a bounding box during rendering.
            </p>
            <video id="matting-video" controls playsinline height="100%">
              <source src="./static/videos/matting.mp4"
                      type="video/mp4">
            </video>
          </div>

        </div>
      </div>
    </div>

    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Animation</h2>


        <h3 class="title is-4">Interpolating states</h3>
        <div class="content has-text-justified">
          <p>
            We can also animate the scene by interpolating the deformation latent codes of two input
            frames. Use the slider here to linearly interpolate between the left frame and the right
            frame.
          </p>
        </div>
        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-3 has-text-centered">
            <img src="./static/images/interpolate_start.jpg"
                 class="interpolation-image"
                 alt="Interpolate start reference image."/>
            <p>Start Frame</p>
          </div>
          <div class="column interpolation-video-column">
            <div id="interpolation-image-wrapper">
              Loading...
            </div>
            <input class="slider is-fullwidth is-large is-info"
                   id="interpolation-slider"
                   step="1" min="0" max="100" value="0" type="range">
          </div>
          <div class="column is-3 has-text-centered">
            <img src="./static/images/interpolate_end.jpg"
                 class="interpolation-image"
                 alt="Interpolation end reference image."/>
            <p class="is-bold">End Frame</p>
          </div>
        </div>
        <br/>

        <h3 class="title is-4">Re-rendering the input video</h3>
        <div class="content has-text-justified">
          <p>
            Using <span class="dnerf">Nerfies</span>, you can re-render a video from a novel
            viewpoint such as a stabilized camera by playing back the training deformations.
          </p>
        </div>
        <div class="content has-text-centered">
          <video id="replay-video"
                 controls
                 muted
                 preload
                 playsinline
                 width="75%">
            <source src="./static/videos/replay.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Related Links</h2>

        <div class="content has-text-justified">
          <p>
            There's a lot of excellent work that was introduced around the same time as ours.
          </p>
          <p>
            <a href="https://arxiv.org/abs/2104.09125">Progressive Encoding for Neural Optimization</a> introduces an idea similar to our windowed position encoding for coarse-to-fine optimization.
          </p>
          <p>
            <a href="https://www.albertpumarola.com/research/D-NeRF/index.html">D-NeRF</a> and <a href="https://gvv.mpi-inf.mpg.de/projects/nonrigid_nerf/">NR-NeRF</a>
            both use deformation fields to model non-rigid scenes.
          </p>
          <p>
            Some works model videos with a NeRF by directly modulating the density, such as <a href="https://video-nerf.github.io/">Video-NeRF</a>, <a href="https://www.cs.cornell.edu/~zl548/NSFF/">NSFF</a>, and <a href="https://neural-3d-video.github.io/">DyNeRF</a>
          </p>
          <p>
            There are probably many more by the time you are reading this. Check out <a href="https://dellaert.github.io/NeRF/">Frank Dellart's survey on recent NeRF papers</a>, and <a href="https://github.com/yenchenlin/awesome-NeRF">Yen-Chen Lin's curated list of NeRF papers</a>.
          </p>
        </div>
      </div>
    </div>

  </div>
</section> -->


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{Xing2024LumiNet,
  author    = {Xing Xiaoyan, Groh Konrad, Karaoglu Sezer, Gevers Theo , Bhattad Anand },
  title     = {LumiNet: Latent Intrinsics Meets Diffusion Models for Indoor Scene Relighting},
  year      = {2024},
}</code></pre>
  </div>
</section>


<!-- <footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="#" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="#">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer> -->
<!-- <script>
  function magnify(containerId, zoom) {
      const container = document.getElementById(containerId);
      const img = container.querySelector("img");
      const magnifier = container.querySelector(".magnifier");

      container.addEventListener("mousemove", function (e) {
          magnifier.style.display = "block";
          const { left, top, width, height } = container.getBoundingClientRect();
          const x = e.pageX - left - window.scrollX;
          const y = e.pageY - top - window.scrollY;

          // Ensure the magnifier stays within the bounds
          if (x < 0 || y < 0 || x > width || y > height) {
              magnifier.style.display = "none";
              return;
          }

          // Set magnifier position
          magnifier.style.left = `${x - magnifier.offsetWidth / 2}px`;
          magnifier.style.top = `${y - magnifier.offsetHeight / 2}px`;

          // Zoom the image
          const bgPosX = -(x * zoom - magnifier.offsetWidth / 2);
          const bgPosY = -(y * zoom - magnifier.offsetHeight / 2);
          magnifier.style.backgroundImage = `url(${img.src})`;
          magnifier.style.backgroundSize = `${img.width * zoom}px ${img.height * zoom}px`;
          magnifier.style.backgroundPosition = `${bgPosX}px ${bgPosY}px`;
      });

      container.addEventListener("mouseleave", function () {
          magnifier.style.display = "none";
      });
  }

  function magnifyLinked(container1Id, container2Id, zoom) {
      magnify(container1Id, zoom);
      magnify(container2Id, zoom);
  }

  document.addEventListener('DOMContentLoaded', function () {
      // Initialize the carousel
      const glide = new Glide('#image-carousel', {
          type: 'carousel',
          perView: 1,
          focusAt: 'center',
          autoplay: false,
          hoverpause: true
      });

      // Function to reinitialize magnify for the active slide
      function reinitializeMagnify() {
          const activeSlide = document.querySelector('.glide__slide--active');
          if (!activeSlide) return;

          // Find the image containers in the active slide
          const containers = activeSlide.querySelectorAll('.image-container');
          if (containers.length >= 2) {
              const container1 = containers[0];
              const container2 = containers[1];

              magnifyLinked(container1.id, container2.id, 2);
          }
      }

      // Reinitialize magnify on the first load and slide change
      glide.on('mount.after', reinitializeMagnify);
      glide.on('run.after', reinitializeMagnify);

      // Mount the carousel
      glide.mount();
  });
</script>
<script>
  function initializeMagnify(containerId, zoom) {
      const container = document.getElementById(containerId);
      const img = container.querySelector("img");
      const magnifier = container.querySelector(".magnifier");

      container.addEventListener("mousemove", function (e) {
          magnifier.style.display = "block";
          const rect = container.getBoundingClientRect();
          const x = e.pageX - rect.left - window.scrollX;
          const y = e.pageY - rect.top - window.scrollY;

          // Ensure magnifier stays within bounds
          if (x < 0 || y < 0 || x > rect.width || y > rect.height) {
              magnifier.style.display = "none";
              return;
          }

          magnifier.style.left = `${x - magnifier.offsetWidth / 2}px`;
          magnifier.style.top = `${y - magnifier.offsetHeight / 2}px`;

          // Zoom effect
          const bgX = -(x * zoom - magnifier.offsetWidth / 2);
          const bgY = -(y * zoom - magnifier.offsetHeight / 2);
          magnifier.style.backgroundImage = `url(${img.src})`;
          magnifier.style.backgroundSize = `${img.width * zoom}px ${img.height * zoom}px`;
          magnifier.style.backgroundPosition = `${bgX}px ${bgY}px`;
      });

      container.addEventListener("mouseleave", () => {
          magnifier.style.display = "none";
      });
  }

  function setupMagnifyForSlide(slide) {
      const containers = slide.querySelectorAll('.image-container');
      containers.forEach(container => {
          const containerId = container.id;
          initializeMagnify(containerId, 2); // 2x zoom
      });
  }

  document.addEventListener('DOMContentLoaded', function () {
      const glide = new Glide('#image-carousel', {
          type: 'carousel',
          perView: 1,
          focusAt: 'center',
          autoplay: false,
          hoverpause: true
      });

      glide.on('mount.after', () => {
          const activeSlide = document.querySelector('.glide__slide--active');
          setupMagnifyForSlide(activeSlide);
      });

      glide.on('run.after', () => {
          const activeSlide = document.querySelector('.glide__slide--active');
          setupMagnifyForSlide(activeSlide);
      });

      glide.mount();
  });
</script> -->


</body>
</html>
