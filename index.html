<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="LumiNet: Latent Intrinsics Meets Diffusion Models for Indoor Scene Relighting.">
  <meta name="keywords" content="LumiNet">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ðŸ’¡ LumiNet</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" src="ðŸ’¡">
  <!-- Glide.js CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.core.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.theme.min.css">

  <!-- Glide.js JavaScript -->
  <!-- <script src="./scripts/carousel.js"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/glide.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="./static/js/magnify.js"></script>

  <style>
    body {
        font-family: Arial, sans-serif;
    }
    .container {
      max-width: 1200px; /* Adjust as needed */
      margin: 0 auto; /* Centers the container horizontally */
      padding: 20px; /* Optional: add padding for spacing */
      display: block; /* Ensure it behaves as a block-level element */
  }
  
    .image-container {
        position: relative;
        display: inline-block;
        width: 300px;
        height: 450px;
        overflow: hidden;
    }
    .image-container img {
        width: 100%;
        height: auto;
    }
  </style>
  
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">ðŸ’¡ LumiNet: Latent Intrinsics Meets Diffusion Models for Indoor Scene Relighting</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://xyxingx.github.io">Xiaoyan Xing</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://www.bosch-ai.com/about-us/our-people/konrad-groh/">Konrad Groh</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://karaoglusezer.github.io/">Sezer Karaoglu</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://staff.fnwi.uva.nl/th.gevers/">Theo Gevers</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://anandbhattad.github.io/">Anand Bhattad</a><sup>3</sup>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>UvA-Bosch Delta Lab</span>
            <span class="author-block"><sup>2</sup>BCAI-Bosch</span>
            <span class="author-block"><sup>3</sup>Toyota Technological Institute at Chicago</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="./static/arxiv.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="#"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video (Coming Soon)</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <!-- <span class="link-block">
                <a href="#"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Coming soon)</span>
                  </a>
              </span> -->

            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <div class="columns is-centered">
        <!-- <div class="column is-four-fifths"> -->
      <img src="./static/images/new_teaser_v5.svg">
    </div>
  <!-- </div> -->
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">LumiNet</span> transfers complex lighting conditions from a target image (a) to a source image (b),
         synthesizing a relit version of the source image (c) while preserving its main geometry and albedo. 
      </h2>
      
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>We introduce LumiNet, a novel architecture that leverages generative models and latent intrinsic representations for effective lighting transfer. </p>
          
          <p>Given a source image and a target lighting image, LumiNet synthesizes a relit version of the source scene that captures the target's lighting.  
            Our approach makes two key contributions: a data curation strategy from the StyleGAN-based relighting model for our training, and a modified diffusion-based ControlNet that processes both latent intrinsic properties from the source image and latent extrinsic properties from the target image. We further improve lighting transfer through a learned adaptor (MLP) that injects the target's latent extrinsic properties via cross-attention and fine-tuning. </p>

          <p>Unlike traditional ControlNet, which generates images with conditional maps from a single scene, LumiNet processes latent representations from two different images - preserving geometry and albedo from the source while transferring lighting characteristics from the target.
             Experiments demonstrate that our method successfully transfers complex lighting phenomena including specular highlights and indirect illumination across scenes with varying spatial layouts and materials, outperforming existing approaches on challenging indoor scenes using only images as input.</p>
          </p>
        </div>
      </div>
    </div>
    <!-- <div class="col-md-10 col-md-offset-1"> -->
     
    <!-- </div> -->
    <!-- <script>
      document.addEventListener('DOMContentLoaded', function () {
          new Glide('#image-carousel', {
              type: 'carousel',
              perView: 1,
              focusAt: 'center',
              autoplay: false,
              hoverpause: true
          }).mount();
      });
  </script> -->
  

    <!-- <script>
        // Initialize magnify for each image container
        magnify("image1", 2); // Pass container ID and zoom level
        magnify("image2", 2);
    </script> -->

    
  
  
  
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video (Coming Soon)</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-three-fifths">
        <h2 class="title is-3">Lighting Transfer Results</h2>
        <p>We present some of the relighting results here. Given a target light (top row) and a scene to be relit (second row), 
          our method transfers complex indoor scene lighting phenomenaâ€”including direct illumination, 
          specular highlights, cast shadows, inter-reflections, and other indirect effectsâ€”while maintaining scene geometry and albedo. (Put your mouse on the images to magnify.) </p>
        
        <!-- Dynamic Image Selection and Display Section -->
        <div>
          <!-- Step 1: Image Selection -->
          <!-- Step 1: Image Selection -->
          <div class="image-selection">
            
            <img src="./static/images/TL_2/860.png" alt="Guide Image 2" data-id="2">
            <img src="./static/images/TL_1/low_light.png" alt="Guide Image 1" data-id="1">
            <img src="./static/images/TL_3/2066.png" alt="Guide Image 3" data-id="3">
            <img src="./static/images/TL_4/102798.png" alt="Guide Image 4" data-id="4">
            <p>Target light</p>
          </div>

          <!-- Step 2: Dynamic Display with Slider -->
          <div class="dynamic-display columns is-centered">
            <div class="column is-half">
              <div class="image-box" id="box1">
                <img src="./static/images/placeholder1.jpg" alt="Dynamic Image 1">
                <p>Original image</p>
                <div class="magnifier" id="magnifier1"></div>
              </div>
            </div>
            <div class="column is-half">
              <div class="image-box" id="box2">
                <img src="./static/images/placeholder2.jpg" alt="Dynamic Image 2">
                <p>Relit image</p>
                <div class="magnifier" id="magnifier2"></div>
              </div>
            </div>
          </div>
          

          <!-- Slider Navigation -->
          <div class="controls">
            <button id="prev" class="button is-dark">â—€ Previous Scene</button>
            <button id="next" class="button is-dark">Next Scene â–¶</button>
          </div>

          <style>
            /* Step 1: Smaller Guide Images */
            .image-selection img {
              width: 80px;  /* Adjust the width as needed */
              height: 80px;
              object-fit: cover;
              cursor: pointer;
              border: 2px solid transparent;
            }

            /* Highlight selected guide image */
            .image-selection img.selected {
              border-color: blue;
            }

            /* Step 2: Adjust Image Box */
            .image-box {
              position: relative;
              width:100%;  /* Full width of the column */
              overflow: hidden;
              border: 2px solid #ccc;
            }

            .image-box img {
              width: 100%;
              height: auto;
              object-fit: cover;
            }

            /* Center the controls */
            .controls {
              display: flex;
              justify-content: center;
              margin-top: 10px;
              gap: 10px;
            }
          </style>

        <!--/ Dynamic Image Selection and Display Section -->
        
      </div>
    </div>
  </div>
</section>


<!-- <section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Visual Comparison</h2>
        <div class="columns is-multiline is-centered">
          <div class="column is-one-sixth">
            <div class="image-box" id="box1">
              <img src="./static/images/placeholder1.jpg" alt="Dynamic Image 1">
              <p>Target light</p>
            </div>
          </div>
          <div class="column is-one-sixth">
            <div class="image-box" id="box1">
              <img src="./static/images/placeholder1.jpg" alt="Dynamic Image 1">
              <p>Original image</p>
            </div>
          </div>
          <div class="column is-one-sixth">
            <div class="image-box" id="box2">
              <img src="./static/images/placeholder2.jpg" alt="Dynamic Image 2">
              <p>RGB-X</p>
            </div>
          </div>
          <div class="column is-one-sixth">
            <div class="image-box" id="box2">
              <img src="./static/images/placeholder2.jpg" alt="Dynamic Image 2">
              <p>IC-Light-V2</p>
            </div>
          </div>
          <div class="column is-one-sixth">
            <div class="image-box" id="box2">
              <img src="./static/images/placeholder2.jpg" alt="Dynamic Image 2">
              <p>Latent-Intrinsic</p>
            </div>
          </div>
          <div class="column is-one-sixth">
            <div class="image-box" id="box2">
              <img src="./static/images/placeholder2.jpg" alt="Dynamic Image 2">
              <p>Ours</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section> -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Visual Comparison</h2>
        <p> We compare <span class="dnerf">LumiNet</span> with IC-Light-v2, RGB-X, and Latent-Intrinsic. Both RGB-X and IC-Light-v2 require text prompts to achieve relighting, where we use descriptions derived from the target lighting image (including actions like turning lights on/off, lamp placement, and scene type) as text prompts.</p>
        <div id="comparison-slider" class="columns is-multiline is-centered">
          <!-- Initial batch of images will be loaded here -->
        </div>
        <div class="controls">
          <button id="prev-batch" class="button is-dark">â—€ Previous Scene</button>
          <button id="next-batch" class="button is-dark">Next Scene â–¶</button>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const comparisonSlider = document.getElementById('comparison-slider');
    const prevBatchButton = document.getElementById('prev-batch');
    const nextBatchButton = document.getElementById('next-batch');

    const comparisonBatches = [
      [
        { src: './static/images/compare/target-1.png', label: 'Target light' },
        { src: './static/images/compare/Original-1.png', label: 'Original image' },
        { src: './static/images/compare/RGBX-1.png', label: 'RGB-X' },
        { src: './static/images/compare/IC-Light-1.png', label: 'IC-Light-V2' },
        { src: './static/images/compare/Latent-Intrinsic-1.png', label: 'Latent-Intrinsic' },
        { src: './static/images/compare/Ours-1.png', label: 'Ours' }
      ],
      [
        { src: './static/images/compare/target-2.png', label: 'Target light' },
        { src: './static/images/compare/Original-2.png', label: 'Original image' },
        { src: './static/images/compare/RGBX-2.png', label: 'RGB-X' },
        { src: './static/images/compare/IC-Light-2.png', label: 'IC-Light-V2' },
        { src: './static/images/compare/Latent-Intrinsic-2.png', label: 'Latent-Intrinsic' },
        { src: './static/images/compare/Ours-2.png', label: 'Ours' }
      ],
      [
        { src: './static/images/compare/target-3.png', label: 'Target light' },
        { src: './static/images/compare/Original-3.png', label: 'Original image' },
        { src: './static/images/compare/RGBX-3.png', label: 'RGB-X' },
        { src: './static/images/compare/IC-Light-3.png', label: 'IC-Light-V2' },
        { src: './static/images/compare/Latent-Intrinsic-3.png', label: 'Latent-Intrinsic' },
        { src: './static/images/compare/Ours-3.png', label: 'Ours' }
      ]
      
      // Add more batches as needed
    ];

    let currentBatchIndex = 0;

    function loadComparisonBatch(index) {
      comparisonSlider.innerHTML = '';
      const batch = comparisonBatches[index];
      batch.forEach(item => {
        const column = document.createElement('div');
        column.className = 'column is-one-fifth';
        column.innerHTML = `
          <div class="image-box">
            <img src="${item.src}" alt="${item.label}">
            <p>${item.label}</p>
          </div>
        `;
        comparisonSlider.appendChild(column);
      });
    }

    prevBatchButton.addEventListener('click', () => {
      currentBatchIndex = (currentBatchIndex - 1 + comparisonBatches.length) % comparisonBatches.length;
      loadComparisonBatch(currentBatchIndex);
    });

    nextBatchButton.addEventListener('click', () => {
      currentBatchIndex = (currentBatchIndex + 1) % comparisonBatches.length;
      loadComparisonBatch(currentBatchIndex);
    });

    // Load the initial batch
    loadComparisonBatch(currentBatchIndex);
  });
</script>

<section>
<div class="container is-max-desktop">
  <div class="content">
    <h2 class="title is-3">Acknowledgements</h2>
    <p>We thank Pingping Song, Melis &Ouml;cal, and Alexander Timans for their insightful discussions. We are also grateful to David Forsyth for his suggestion to emphasize that light in scenes cannot simply appear, along with other valuable comments on our manuscript. Additionally, we thank Xiao Zhang for providing the code and model for Latent Intrinsic. Finally, we thank all our participants for their time in finishing our user study. This project is financially supported by Bosch (Bosch Center for Artificial Intelligence), the University of Amsterdam and the allowance of Top consortia for Knowledge and Innovation (TKIs) from the Netherlands Ministry of Economic Affairs and Climate Policy.</p>
  </div>
</div>
</section>

<style>
  .magnifier {
    position: absolute;
    border: 2px solid #000;
    border-radius: 50%;
    cursor: none;
    pointer-events: none;
    width: 65px;
    height: 65px;
    display: none;
    background-repeat: no-repeat;
    background-color: rgba(255, 255, 255, 0.6);
    box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
  }
</style>

<!-- JavaScript: Add Magnifier Functionality -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const guideImages = document.querySelectorAll('.image-selection img');
    let selectedGuideImage = null;
    let currentImageIndex = 0;

    const relatedImages = {
      1: ["./static/images/TL_1/s1l0.png", "./static/images/TL_1/s1l1.png", "./static/images/TL_1/s1t0.png", "./static/images/TL_1/s1t1.png"],
      2: ["./static/images/TL_2/s2t0.png", "./static/images/TL_2/s2t1.png", "./static/images/TL_2/s6l1.png", "./static/images/TL_2/s6l0.png"],
      3: ["./static/images/TL_3/s0l0.png", "./static/images/TL_3/s0l1.png", "./static/images/TL_3/s3l0.png", "./static/images/TL_3/s3l1.png"],
      4: ["./static/images/TL_4/s5l0.png", "./static/images/TL_4/s5l1.png", "./static/images/TL_4/s0l0.png", "./static/images/TL_4/s0l1.png"]
    };

    const box1 = document.querySelector('#box1 img');
    const box2 = document.querySelector('#box2 img');
    const magnifier1 = document.querySelector('#magnifier1');
    const magnifier2 = document.querySelector('#magnifier2');
    const prevButton = document.getElementById('prev');
    const nextButton = document.getElementById('next');

    guideImages.forEach((image) => {
      image.addEventListener('click', () => {
        guideImages.forEach((img) => img.classList.remove('selected'));
        image.classList.add('selected');
        selectedGuideImage = image.dataset.id;
        currentImageIndex = 0;
        loadDynamicImages();
      });
    });

    function loadDynamicImages() {
      if (selectedGuideImage && relatedImages[selectedGuideImage]) {
        const images = relatedImages[selectedGuideImage];
        box1.src = images[currentImageIndex % images.length];
        box2.src = images[(currentImageIndex + 1) % images.length];
      }
    }

    prevButton.addEventListener('click', () => {
      if (selectedGuideImage && relatedImages[selectedGuideImage]) {
        const images = relatedImages[selectedGuideImage];
        currentImageIndex = (currentImageIndex - 2 + images.length) % images.length;
        loadDynamicImages();
      }
    });

    nextButton.addEventListener('click', () => {
      if (selectedGuideImage && relatedImages[selectedGuideImage]) {
        const images = relatedImages[selectedGuideImage];
        currentImageIndex = (currentImageIndex + 2) % images.length;
        loadDynamicImages();
      }
    });

    // Magnify logic for synchronized magnification
    function magnify(container, magnifier, img, zoom) {
      container.addEventListener('mousemove', (e) => {
        const rect = container.getBoundingClientRect();
        const x = e.pageX - rect.left - window.scrollX;
        const y = e.pageY - rect.top - window.scrollY;

        if (x < 0 || y < 0 || x > rect.width || y > rect.height) {
          magnifier.style.display = 'none';
          return;
        }

        magnifier.style.display = 'block';
        magnifier.style.left = `${x - magnifier.offsetWidth / 2}px`;
        magnifier.style.top = `${y - magnifier.offsetHeight / 2}px`;
        magnifier.style.backgroundImage = `url(${img.src})`;
        magnifier.style.backgroundSize = `${img.width * zoom}px ${img.height * zoom}px`;
        magnifier.style.backgroundPosition = `-${x * zoom - magnifier.offsetWidth / 2}px -${y * zoom - magnifier.offsetHeight / 2}px`;

        // Synchronize the second magnifier
        if (magnifier === magnifier1) {
          magnifier2.style.display = 'block';
          magnifier2.style.left = magnifier.style.left;
          magnifier2.style.top = magnifier.style.top;
          magnifier2.style.backgroundImage = `url(${box2.src})`;
          magnifier2.style.backgroundSize = `${box2.width * zoom}px ${box2.height * zoom}px`;
          magnifier2.style.backgroundPosition = magnifier.style.backgroundPosition;
        } else {
          magnifier1.style.display = 'block';
          magnifier1.style.left = magnifier.style.left;
          magnifier1.style.top = magnifier.style.top;
          magnifier1.style.backgroundImage = `url(${box1.src})`;
          magnifier1.style.backgroundSize = `${box1.width * zoom}px ${box1.height * zoom}px`;
          magnifier1.style.backgroundPosition = magnifier.style.backgroundPosition;
        }
      });

      container.addEventListener('mouseleave', () => {
        magnifier.style.display = 'none';
        magnifier1.style.display = 'none';
        magnifier2.style.display = 'none';
      });
    }

    magnify(document.querySelector('#box1'), magnifier1, box1, 2);
    magnify(document.querySelector('#box2'), magnifier2, box2, 2);

    guideImages[0].click();
  });
</script>






<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{Xing2024LumiNet,
  author    = {Xing Xiaoyan, Groh Konrad, Karaoglu Sezer, Gevers Theo, Bhattad Anand},
  title     = {LumiNet: Latent Intrinsics Meets Diffusion Models for Indoor Scene Relighting},
  year      = {2024},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/arxiv.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="#" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            The core code of this website is borrowed from <a
            href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>. 
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>
<!-- <script>
  function magnify(containerId, zoom) {
      const container = document.getElementById(containerId);
      const img = container.querySelector("img");
      const magnifier = container.querySelector(".magnifier");

      container.addEventListener("mousemove", function (e) {
          magnifier.style.display = "block";
          const { left, top, width, height } = container.getBoundingClientRect();
          const x = e.pageX - left - window.scrollX;
          const y = e.pageY - top - window.scrollY;

          // Ensure the magnifier stays within the bounds
          if (x < 0 || y < 0 || x > width || y > height) {
              magnifier.style.display = "none";
              return;
          }

          // Set magnifier position
          magnifier.style.left = `${x - magnifier.offsetWidth / 2}px`;
          magnifier.style.top = `${y - magnifier.offsetHeight / 2}px`;

          // Zoom the image
          const bgPosX = -(x * zoom - magnifier.offsetWidth / 2);
          const bgPosY = -(y * zoom - magnifier.offsetHeight / 2);
          magnifier.style.backgroundImage = `url(${img.src})`;
          magnifier.style.backgroundSize = `${img.width * zoom}px ${img.height * zoom}px`;
          magnifier.style.backgroundPosition = `${bgPosX}px ${bgPosY}px`;
      });

      container.addEventListener("mouseleave", function () {
          magnifier.style.display = "none";
      });
  }

  function magnifyLinked(container1Id, container2Id, zoom) {
      magnify(container1Id, zoom);
      magnify(container2Id, zoom);
  }

  document.addEventListener('DOMContentLoaded', function () {
      // Initialize the carousel
      const glide = new Glide('#image-carousel', {
          type: 'carousel',
          perView: 1,
          focusAt: 'center',
          autoplay: false,
          hoverpause: true
      });

      // Function to reinitialize magnify for the active slide
      function reinitializeMagnify() {
          const activeSlide = document.querySelector('.glide__slide--active');
          if (!activeSlide) return;

          // Find the image containers in the active slide
          const containers = activeSlide.querySelectorAll('.image-container');
          if (containers.length >= 2) {
              const container1 = containers[0];
              const container2 = containers[1];

              magnifyLinked(container1.id, container2.id, 2);
          }
      }

      // Reinitialize magnify on the first load and slide change
      glide.on('mount.after', reinitializeMagnify);
      glide.on('run.after', reinitializeMagnify);

      // Mount the carousel
      glide.mount();
  });
</script>
<script>
  function initializeMagnify(containerId, zoom) {
      const container = document.getElementById(containerId);
      const img = container.querySelector("img");
      const magnifier = container.querySelector(".magnifier");

      container.addEventListener("mousemove", function (e) {
          magnifier.style.display = "block";
          const rect = container.getBoundingClientRect();
          const x = e.pageX - rect.left - window.scrollX;
          const y = e.pageY - rect.top - window.scrollY;

          // Ensure magnifier stays within bounds
          if (x < 0 || y < 0 || x > rect.width || y > rect.height) {
              magnifier.style.display = "none";
              return;
          }

          magnifier.style.left = `${x - magnifier.offsetWidth / 2}px`;
          magnifier.style.top = `${y - magnifier.offsetHeight / 2}px`;

          // Zoom effect
          const bgX = -(x * zoom - magnifier.offsetWidth / 2);
          const bgY = -(y * zoom - magnifier.offsetHeight / 2);
          magnifier.style.backgroundImage = `url(${img.src})`;
          magnifier.style.backgroundSize = `${img.width * zoom}px ${img.height * zoom}px`;
          magnifier.style.backgroundPosition = `${bgX}px ${bgY}px`;
      });

      container.addEventListener("mouseleave", () => {
          magnifier.style.display = "none";
      });
  }

  function setupMagnifyForSlide(slide) {
      const containers = slide.querySelectorAll('.image-container');
      containers.forEach(container => {
          const containerId = container.id;
          initializeMagnify(containerId, 2); // 2x zoom
      });
  }

  document.addEventListener('DOMContentLoaded', function () {
      const glide = new Glide('#image-carousel', {
          type: 'carousel',
          perView: 1,
          focusAt: 'center',
          autoplay: false,
          hoverpause: true
      });

      glide.on('mount.after', () => {
          const activeSlide = document.querySelector('.glide__slide--active');
          setupMagnifyForSlide(activeSlide);
      });

      glide.on('run.after', () => {
          const activeSlide = document.querySelector('.glide__slide--active');
          setupMagnifyForSlide(activeSlide);
      });

      glide.mount();
  });
</script> -->


</body>
</html>
